<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"HTTP://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">
	<!-- 로그인 처리 -->
	<select id="login" resultType="java.util.HashMap" parameterType="java.util.HashMap">
	select * from member where mid=#{mid} and mpw=#{mpw}
	</select>
	
	<!-- 카카오 아이디 확인 -->
	<select id="kakao" resultType="java.util.HashMap" parameterType="memDTO">
	select * from member where mid=#{mid}
	</select>
	
	<insert id="kinsert" parameterType="memDTO">
	insert into member(mno,mid) values(mno_seq.nextval,#{mid})
	</insert>
	
	<!-- 회원 수 조회 -->
	<select id="totalCnt" resultType="Integer">
		select  count(*) from member
	</select>
	
	<!-- 회원 리스트 출력 --> <!-- 회원 번호가 아닌 ROWNUM()순서로 정렬하여 출력한다 -->
	<select id="list" resultType="java.util.HashMap" parameterType="PageUtil">
	select * from (select row_number() over (order by mno) num, 
	A.* from member A order by mno desc)
	where num between#{startNo} and #{endNo} order by mno desc
	</select>
	
	<!-- 회원 검색 및 리스트 출력--> <!-- 회원 번호가 아닌 ROWNUM()순서로 정렬하여 출력한다 -->
	<select id="searchList" resultType="java.util.HashMap" parameterType="PageUtil">
		select * from(
			select row_number() over (order by mno) num,
			A.* from member A 
				where mid like '%${searchWord}%' 
				order by mno desc)
		where num between #{startNo} and #{endNo}
	</select>
	
	<!-- 회원 정보 출력 -->
	<select id="memInfo" resultType="memDTO" parameterType="memDTO">
	select * from member where mno = #{mno}
	</select>
	
	<!-- 최근 접속일 갱신 -->
	<update id="logDate" parameterType="java.util.HashMap">
		UPDATE member SET mlogdate=sysdate where mno=#{mno}
	</update>
	
	<update id="memUpdate" parameterType="memDTO">
		UPDATE member 
		SET mid='${mid}', mpw='${mpw}', memail='${memail}', mname='${mname}', mnick='${mnick}', mbirth='${mbirth}', mtel='${mtel}', mtel2='${mtel2}', mtype=${mtype}
		where mno=#{mno}
	</update>
	
	<delete id="memDelete" parameterType="Integer">
		delete member where mno=#{mno}
	</delete>
</mapper>
	
