<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"HTTP://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="question">
	<!-- 전체게시물 수 조회 -->
	<select id="totalCnt" resultType="Integer">
	select count(*) from question where qid=#{id} and qtype=1
	</select>
	
	<!-- question리스트 출력 -->
	<select id="list" resultType="queDTO" parameterType="PageUtil">
	select * from (select row_number() over( order by question.qid desc) as rno,question.* from question) where rno between ${startNo} and ${endNo} order by rno desc
	</select>
	
	<!-- 글쓰기 -->
	<insert id="insert" parameterType="queDTO">
	insert into question values(qno_seq.nextval,#{qtitle},#{qid},#{qdate},#{qcontent},1)
	</insert>
	
	<!-- 상세보기 -->
	<select id="detail" resultType="queDTO" parameterType="queDTO">
	select * from question,(select count(*) as qcount from questioncomment where qno=${qno}) where qno=${qno}
	</select>
	
	<!-- 댓글 -->
	<select id="detailcomm" resultType="queDTO" parameterType="queDTO">
	select * from question q,questioncomment c where q.qno=#{qno} and q.qno=c.qno
	</select>
	
	<!-- 삭제 -->
	<delete id="delete" parameterType="queDTO">
	delete from question where qno=#{qno}
	</delete>
	
	<!-- 수정 -->
	<update id="update" parameterType="queDTO">
	update question set qtitle=#{qtitle},qdate=#{qdate},qcontent=#{qcontent} where qno=#{qno} and qid=#{qid}
	</update>
</mapper>
	
